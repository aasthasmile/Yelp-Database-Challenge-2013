DROP VIEW DATE1;
DROP VIEW DATE2;


CREATE VIEW date1 AS
SELECT (R.B_ID) AS BID, AVG( R.RATING) AS RATES,COUNT(*) AS REVIEWS1
FROM REVIEWS R
WHERE EXTRACT( MONTH FROM R.PUBLISH_DATE) =5
AND EXTRACT( YEAR FROM R.PUBLISH_DATE) =2011
group by R.B_ID, (R.B_ID) 
ORDER BY AVG(R.RATING) DESC;

CREATE VIEW date2 AS
SELECT (R.B_ID) AS BID, AVG( R.RATING) AS RATES,COUNT(*) AS REVIEWS2
FROM REVIEWS R
WHERE EXTRACT( MONTH FROM R.PUBLISH_DATE) =6
AND EXTRACT( YEAR FROM R.PUBLISH_DATE) =2011
group by R.B_ID, (R.B_ID) 
ORDER BY AVG(R.RATING) DESC;

SELECT B.BUISNESS_ID,B.BUISNESS_NAME,(DATE2.RATES - DATE1.RATES) AS JUMP
FROM BUISNESS B  
INNER JOIN DATE1
ON B.BUISNESS_ID=DATE1.BID
INNER JOIN DATE2
ON B.BUISNESS_ID=DATE2.BID
WHERE (DATE2.RATES - DATE1.RATES)>1
ORDER BY JUMP DESC,  B.BUISNESS_ID ASC,B.BUISNESS_NAME ASC;
