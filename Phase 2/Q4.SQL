/*Student Name:Aastha Jain ,Student ID:014868722*/

/*QUERY4*/


SELECT B.BUISNESS_ID,AVG(R.RATING) AS STARS,COUNT(*) AS NO_REVIEWS
FROM BUISNESS B INNER JOIN REVIEWS R
ON B.BUISNESS_ID=R.B_ID
WHERE B.STATES LIKE '%CA%' 
AND B.CITY like '%San Jose%'
AND B.BSN_CATG IN
    ( 
    SELECT BCD.BSN_CATG_ID
    FROM BUISNESS_CATEGORY BCD
    WHERE BCD.BSN_CATG_NAME like 'Breakfast and Brunch'
    )
AND ROWNUM<= 10        
group by B.BUISNESS_ID
ORDER BY STARS DESC,NO_REVIEWS DESC,B.BUISNESS_ID ASC;



